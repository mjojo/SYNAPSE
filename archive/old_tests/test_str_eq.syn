// Test str_eq function
fn str_len(s) {
    let i = 0
    while getbyte(s, i) > 0 {
        i = i + 1
    }
    return i
}

fn io_print(s) {
    let len = str_len(s)
    let h = getstd(-11)
    write(h, s, len)
    return 0
}

fn io_println(s) {
    io_print(s)
    io_print("\n")
    return 0
}

fn str_eq(a, b) {
    let i = 0
    let eq = 1
    while eq == 1 {
        let ca = getbyte(a, i)
        let cb = getbyte(b, i)
        if ca != cb { eq = 0 }
        if ca == 0 { return eq }
        i = i + 1
    }
    return 0
}

fn main() {
    io_println("Testing str_eq")
    
    // Build "fn" using alloc + setbyte
    let fn_str = alloc(4)
    setbyte(fn_str, 0, 102)  // f
    setbyte(fn_str, 1, 110)  // n
    setbyte(fn_str, 2, 0)
    
    io_println("Built fn_str")
    io_print("fn_str = ")
    io_println(fn_str)
    
    // Build another "fn"
    let fn2 = alloc(4)
    setbyte(fn2, 0, 102)  // f
    setbyte(fn2, 1, 110)  // n
    setbyte(fn2, 2, 0)
    
    io_println("Built fn2")
    
    io_println("Calling str_eq")
    let result = str_eq(fn_str, fn2)
    
    io_print("Result = ")
    if result == 1 { io_println("EQUAL") }
    if result == 0 { io_println("NOT EQUAL") }
    
    return result
}
