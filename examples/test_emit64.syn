// Test emit64 separately

let g_jit = 0
let g_jit_idx = 0

fn emit(b) {
    set_byte(g_jit, g_jit_idx, b)
    g_jit_idx = g_jit_idx + 1
    return 0
}

fn emit64(val) {
    let i = 0
    let v = 0
    let b = 0
    let d = 0
    
    v = val
    i = 0
    while (i < 8) {
        d = v / 256
        b = v - (d * 256)
        emit(b)
        v = d
        i = i + 1
    }
    return 0
}

fn main() {
    let i = 0
    let b = 0
    
    puts("=== EMIT64 TEST ===")
    
    g_jit = alloc(256)
    g_jit_idx = 0
    
    puts("Emitting 123 as 8 bytes...")
    emit64(123)
    
    puts("Bytes:")
    print(g_jit_idx)
    
    i = 0
    while (i < g_jit_idx) {
        b = get_byte(g_jit, i)
        print(b)
        i = i + 1
    }
    
    puts("Expected: 123 0 0 0 0 0 0 0")
    puts("=== DONE ===")
    return 0
}
