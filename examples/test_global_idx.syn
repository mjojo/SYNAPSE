// Test: global array[global_index] = value in if inside while

let g_arr = 0
let g_idx = 0

fn test() {
    let i = 0
    let c = 0
    
    puts("Testing with global index")
    puts("g_arr:")
    print(g_arr)
    puts("g_idx:")
    print(g_idx)
    
    i = 0
    while (i < 3) {
        c = i + 100
        
        if (c == 100) {
            puts("c=100, writing to g_arr[g_idx]")
            g_arr[g_idx] = 42
            puts("Read back:")
            print(g_arr[g_idx])
            g_idx = g_idx + 1
        }
        
        if (c == 101) {
            puts("c=101, writing to g_arr[g_idx]")
            g_arr[g_idx] = 43
            puts("Read back:")
            print(g_arr[g_idx])
            g_idx = g_idx + 1
        }
        
        i = i + 1
    }
    
    puts("Final:")
    puts("g_idx =")
    print(g_idx)
    puts("g_arr[0] =")
    print(g_arr[0])
    puts("g_arr[1] =")
    print(g_arr[1])
    
    return 0
}

fn main() {
    g_arr = alloc(256)
    g_idx = 0
    test()
    return 0
}
